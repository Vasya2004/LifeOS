# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å

### 1. –¢–∞–±–ª–∏—Ü—ã –≤ Supabase (28 —à—Ç—É–∫)
- –í—Å–µ —Å—É—â–Ω–æ—Å—Ç–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ PostgreSQL
- RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –∑–∞—â–∏—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ
- Realtime –≤–∫–ª—é—á—ë–Ω –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü

### 2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –≤—Ö–æ–¥–µ
```typescript
// –ü—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è SyncEngineV2
2. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è pullFromServer() - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è toast "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."
```

### 3. –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```typescript
// –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏/—Ü–µ–ª–∏/–ø—Ä–∏–≤—ã—á–∫–∏:
1. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage (IndexedDB)
2. –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```

### 4. –†–µ–∞–ª—Ç–∞–π–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø—Ä–∏—Ö–æ–¥—è—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üß™ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

1. **–í–æ–π–¥–∏—Ç–µ** –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. **–°–æ–∑–¥–∞–π—Ç–µ —Ü–µ–ª—å**: –ù–∞–∑–≤–∞–Ω–∏–µ "–¢–µ—Å—Ç–æ–≤–∞—è —Ü–µ–ª—å"
3. **–°–æ–∑–¥–∞–π—Ç–µ –∑–∞–¥–∞—á—É**: –ù–∞–∑–≤–∞–Ω–∏–µ "–¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–¥–∞—á–∞"
4. **–í—ã–π–¥–∏—Ç–µ** –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ (–∫–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏")
5. **–í–æ–π–¥–∏—Ç–µ —Å–Ω–æ–≤–∞**
6. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**: –¶–µ–ª—å –∏ –∑–∞–¥–∞—á–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞ –º–µ—Å—Ç–µ

### –¢–µ—Å—Ç 2: –î–≤–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

1. **–í–æ–π–¥–∏—Ç–µ** –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ, —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞–¥–∞—á—É "–ó–∞–¥–∞—á–∞ 1"
2. **–í–æ–π–¥–∏—Ç–µ** –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ –≤ —Ç–æ—Ç –∂–µ –∞–∫–∫–∞—É–Ω—Ç
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**: –ó–∞–¥–∞—á–∞ "–ó–∞–¥–∞—á–∞ 1" –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è
4. **–°–æ–∑–¥–∞–π—Ç–µ** –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ "–ó–∞–¥–∞—á–∞ 2"
5. **–û–±–Ω–æ–≤–∏—Ç–µ** –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ - "–ó–∞–¥–∞—á–∞ 2" –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è

### –¢–µ—Å—Ç 3: –û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º

1. **–û—Ç–∫–ª—é—á–∏—Ç–µ** –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
2. **–°–æ–∑–¥–∞–π—Ç–µ** –∑–∞–¥–∞—á—É "–û—Ñ–ª–∞–π–Ω –∑–∞–¥–∞—á–∞"
3. **–í–∫–ª—é—á–∏—Ç–µ** –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
4. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ** 5 —Å–µ–∫—É–Ω–¥ (–∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
5. **–û–±–Ω–æ–≤–∏—Ç–µ** —Å—Ç—Ä–∞–Ω–∏—Ü—É
6. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**: –ó–∞–¥–∞—á–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è

---

## üìã –ß—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è

| –ú–æ–¥—É–ª—å | –°–æ–∑–¥–∞–Ω–∏–µ | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ | –£–¥–∞–ª–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|--------|----------|------------|----------|--------|
| **Tasks** | ‚úÖ | ‚úÖ | ‚úÖ | –ì–æ—Ç–æ–≤–æ |
| **Goals** | ‚úÖ | ‚úÖ | ‚úÖ | –ì–æ—Ç–æ–≤–æ |
| **Projects** | ‚úÖ | ‚úÖ | ‚úÖ | –ì–æ—Ç–æ–≤–æ |
| **Habits** | ‚úÖ | ‚úÖ | ‚úÖ | –ì–æ—Ç–æ–≤–æ |
| **Finance** | ‚ùå | ‚ùå | ‚ùå | –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å |
| **Health** | ‚ùå | ‚ùå | ‚ùå | –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å |
| **Skills** | ‚ùå | ‚ùå | ‚ùå | –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å |

---

## üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ sync –≤ –¥—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏

–ü—Ä–∏–º–µ—Ä –¥–ª—è finance:

```typescript
// lib/store/finance.ts
import { addToQueue } from "@/lib/sync/offline-first"

export function addAccount(account: Omit<Account, "id">) {
  // ... —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ ...
  
  // –î–æ–±–∞–≤–∏—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
  addToQueue({ 
    table: "accounts", 
    operation: "insert", 
    recordId: newAccount.id, 
    data: newAccount 
  })
}
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### 1. user_id
–í—Å–µ –∑–∞–ø–∏—Å–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç `user_id` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —á–µ—Ä–µ–∑ RLS.
–í –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –µ–≥–æ –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.

### 2. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
–ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç `_version` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.

### 3. –û—á–µ—Ä–µ–¥—å
–ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–æ–∑–∂–µ.

---

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### "–ù–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã:
   ```javascript
   // –í –∫–æ–Ω—Å–æ–ª–∏
   const { data } = await supabase.auth.getUser()
   console.log(data.user) // –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ null
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
   ```javascript
   syncEngineV2.getState()
   ```

### "–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –Ω–µ —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è"

1. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –¥–∏–∞–ª–æ–≥ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
2. –ï—Å–ª–∏ –Ω–µ –ø–æ—è–≤–∏–ª—Å—è - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ `ConflictDialog` –≤ DOM

---

## ‚úÖ –ò—Ç–æ–≥

**–î–∞, —Ç–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å —Ü–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏
2. ‚úÖ –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
3. ‚úÖ –í–æ–π—Ç–∏ –æ–±—Ä–∞—Ç–Ω–æ
4. ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è!

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ (tasks, goals, habits) –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.**
